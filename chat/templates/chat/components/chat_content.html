<!-- Header -->
<div id="chat-header" class="bg-base-200 p-4 flex items-center justify-between">
	{% include 'chat/components/chat_header.html' %}
</div>

<!-- Chat Interface -->
{% if current_chat %}
<div
	id="chat-messages"
	class="flex-1 flex flex-col bg-base-100 shadow-md overflow-y-auto"
	hx-ext="ws"
	ws-connect="/ws/chat/{{ current_chat.id }}/"
>
	{% include 'chat/components/chat_messages.html' %}

	<!-- Message Input Area -->
	<div id="message-input">
		{% include 'chat/components/message_input.html' %}
	</div>
</div>
{% else %}
<div
	id="chat-messages"
	class="flex-1 flex flex-col bg-base-100 shadow-md overflow-y-auto"
>
	<p class="text-center text-gray-500 mt-8">
		Select a chat or create a new one to start messaging.
	</p>
</div>
{% endif %}

<script>
	document.body.addEventListener('htmx:wsAfterMessage', function (event) {
		const message = JSON.parse(event.detail.message);
		if (message.type === 'chat_title_update') {
			const headerTitle = document.querySelector('#chat-header h1');
			if (headerTitle) {
				headerTitle.textContent = message.new_title;
			}
		}
	});
</script>
